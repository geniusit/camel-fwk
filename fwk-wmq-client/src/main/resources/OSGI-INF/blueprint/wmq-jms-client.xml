<?xml version="1.0" encoding="UTF-8"?>

<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0"
           xsi:schemaLocation="
         http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0 http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0/blueprint-cm.xsd
         http://www.osgi.org/xmlns/blueprint/v1.0.0 https://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd">

    <!-- Use fwk.connection.wmq.cfg file located in KARAF_HOME/etc folder to dynamically retrieve properties -->
    <cm:property-placeholder persistent-id="fwk.connection.wmq" update-strategy="reload" />

    <bean id="wmqConnectionFactory" class="com.ibm.mq.jms.MQQueueConnectionFactory">
        <property name="transportType" value="1" />
        <property name="hostName" value="${broker.wmq.host}" />
        <property name="port" value="${broker.wmq.port}" />
        <property name="queueManager" value="${broker.wmq.queuemanager}" />
        <property name="channel" value="${broker.wmq.channel}" />
        <property name="useConnectionPooling" value="true" />
    </bean>

    <service ref="wmqConnectionFactory" interface="javax.jms.ConnectionFactory">
        <service-properties>
            <entry key="name" value="websphereMQ"/>
            <entry key="osgi.jndi.service.name" value="jms/websphereMQ"/>
        </service-properties>
    </service>

</blueprint>